<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>MDOC</title>
    <link href="style.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.ckeditor.com/ckeditor5/28.0.0/decoupled-document/ckeditor.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://rawgit.com/jackmoore/autosize/master/dist/autosize.min.js"></script>
</head>
<body>

<div id="top-bar">
    <div id="link-button"></div>
    <div id="share-button"></div>
    <input id="mdoc-title" onchange="saveDocTitle(this)" th:value="${title}">
    <div id="toolbar-container"></div>
</div>

<div id="new-block">
    <div id="new-block-sign">Добавить новый блок<button id="new-block-close" onclick="hideNewBlock()">X</button></div>
    <input class="new-block-input" id="new-block-title" placeholder="Название блока">
    <input class="new-block-input" id="new-block-author" placeholder="Автор">
    <button id="new-block-submit" onclick="addNewBlock(this.parentElement)">Создать</button>
</div>

<div id="new-version">
    <div id="new-version-sign">Добавить новую версию<button id="new-version-close" onclick="hideNewVersion()">X</button></div>
    <div style="display:flex">
        <div>К блоку #</div><div id="new-version-block-number"></div>
    </div>
    <div style="display:flex">
        "<div id="new-version-block-title"></div>"
    </div>
    <br>
    <input id="new-version-author" placeholder="Автор">
    <button id="new-version-submit" onclick="addNewVersion(this.parentElement)">Создать</button>
</div>

<div id="content" th:fragment="content">

    <div class="block" th:each="block : ${blocks}">
        <div class="version-content" th:each="ver : ${block.getVersions()}" th:utext="${ver.getContent().getContent()}" hidden></div>
        <div class="version-author" th:each="ver : ${block.getVersions()}" th:text="${ver.getAuthor()}" hidden></div>
        <div class="block-content">
            <div class="editor"><textarea class="textarea-editor" onchange="saveVersion(this)">[[${block.getVersions().get(0).getContent().getContent()}]]</textarea></div>
                <!--button class="btn invisible-button" onclick="searchViaAjax()"><svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 24 24"><path d="M15.003 3h2.997v5h-2.997v-5zm8.997 1v20h-24v-24h20l4 4zm-19 5h14v-7h-14v7zm16 4h-18v9h18v-9z"/></svg></button-->
        </div>
        <div class="block-controller">
            <div class="left-ctrl">
                <div class="block-number" th:text="${blocks.indexOf(block)+1}"></div>
                <input class="block-name" onchange="saveBlockTitle(this)" th:value="${block.getTitle()}">
            </div>
            <div class="middle-ctrl">
                <button class="block-left" onclick="changeVersion(this, false)">
                    <
                </button>
                <div class="block-version">1</div>/<div class="block-version block-max-version" th:text="${block.getVersions().size()}"></div>
                <button class="block-right" onclick="changeVersion(this, true)">
                    >
                </button>
            </div>
            <div class="right-ctrl">
                <input class="block-author" th:value="${block.getVersions().get(0).getAuthor()}" onchange="saveVersionAuthor(this)">
                <div class="block-add-version" onclick="showNewVersion(this)">
                    +
                </div>
            </div>
        </div>
    </div>

</div>


<center><div id="add-block-button" onclick="showNewBlock()">+</div></center>


<!-- script src="script.js"></script -->
<script src="redactor.js"></script>

</body>
</html>